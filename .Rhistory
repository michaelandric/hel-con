unique(nn$subject)
length(unique(nn$subject))
for (cl in clusters)
{
tmp <- filter(nn, cluster==cl)
tmp_means <- tapply(tmp$val, tmp$condition, mean)
# tmp_means <- tmp_means[c(1, 2, 4, 3)]
error_vec <- c()
for (i in seq(length(conditions)))
{
er <- sd(filter(tmp, condition==i)$val - tapply(tmp$val, tmp$subject, mean) / sqrt(n_subj))
error_vec <- c(error_vec, er)
}
# error_vec <- error_vec[c(1, 2, 4, 3)]
# ylim <- c(0, 1.21 * max(tmp_means + error_vec))
ylim <- c(0, max(tmp_means + error_vec))
# ab = barplot(tmp_means, beside = TRUE, ylim = ylim, ylab = "Avg. Global Connectivity")
ab = barplot(tmp_means, beside = TRUE, ylim = ylim)
segments(x0 = ab, x1 = ab, y0 = tmp_means, y1 = tmp_means + error_vec)
segments(x0 = ab - .2, x1 = ab + .2, y0 = tmp_means + error_vec, y1 = tmp_means + error_vec)
title(paste("Cluster",cl))
}
n_subj <- length(unique(nn$subject))
for (cl in clusters)
{
tmp <- filter(nn, cluster==cl)
tmp_means <- tapply(tmp$val, tmp$condition, mean)
# tmp_means <- tmp_means[c(1, 2, 4, 3)]
error_vec <- c()
for (i in seq(length(conditions)))
{
er <- sd(filter(tmp, condition==i)$val - tapply(tmp$val, tmp$subject, mean) / sqrt(n_subj))
error_vec <- c(error_vec, er)
}
# error_vec <- error_vec[c(1, 2, 4, 3)]
# ylim <- c(0, 1.21 * max(tmp_means + error_vec))
ylim <- c(0, max(tmp_means + error_vec))
# ab = barplot(tmp_means, beside = TRUE, ylim = ylim, ylab = "Avg. Global Connectivity")
ab = barplot(tmp_means, beside = TRUE, ylim = ylim)
segments(x0 = ab, x1 = ab, y0 = tmp_means, y1 = tmp_means + error_vec)
segments(x0 = ab - .2, x1 = ab + .2, y0 = tmp_means + error_vec, y1 = tmp_means + error_vec)
title(paste("Cluster",cl))
}
er
tmp <- filter(nn, cluster==cl)
tmp_means <- tapply(tmp$val, tmp$condition, mean)
error_vec <- c()
i = 1
sd(filter(tmp, condition==i)$val - tapply(tmp$val, tmp$subject, mean) / sqrt(n_subj))
tmp
i
filter(tmp, condition==i)
filter(tmp, condition==i)$val
tapply(tmp$val, tmp$subject, mean)
tmp$val
tmp
tapply(tmp$val, tmp$subject, mean)
length(tapply(tmp$val, tmp$subject, mean))
tmp
nn
dim(nn)
36*3
rep(seq(3))
rep(seq(3), 10)
length(rep(seq(3), 10))
length(rep(rep(seq(3), 10), 2))
rep(rep(seq(3), 10), 2)
length(rep(seq(3), 2))
length(rep(seq(3), 2))
length(rep(seq(2), 3))
rep(seq(2), 3)
rep(rep(seq(2), 3), 10)
length(rep(rep(seq(2), 3), 10))
length(rep(rep(seq(2), 3), 9))
length(rep(rep(seq(3), 2), 9))
length(rep(rep(seq(3), 2), 8))
rep(rep(seq(3), 2), 8)
rep(rep(seq(3), 2), 8)
rep(rep(seq(2), each=2), 8)
rep(rep(seq(2), each=3), 8)
subjects <- c()
s_nums = seq(1, 19)[seq(1,19) != 9]
for (s in s_nums)
{
subjects <- c(subjects, paste('hel', s, sep=''))
}
subjects
rep(rep(seq(3), 2), 8)
rep(rep(seq(2), each=3), 8)
rep(subjects, each=10)
rep(subjects, each=10)[51]
rep(subjects, each=6)[51]
rep(subjects, each=6)[
]
rep(subjects, each=6)
rep(rep(seq(3), 2), 8)
rep(rep(seq(2), each=3), 8)
nn <- read.csv('avg_corrZ_sess2vals_Clust_mask.cluster_info.csv')
clusters <- unique(nn$cluster)
n_subj <- length(unique(nn$subject))
tmp <- filter(nn, cluster==cl)
tmp_means <- tapply(tmp$val, tmp$condition, mean)
error_vec <- c()
i
sd(filter(tmp, condition==i)$val - tapply(tmp$val, tmp$subject, mean) / sqrt(n_subj))
for (cl in clusters)
{
tmp <- filter(nn, cluster==cl)
tmp_means <- tapply(tmp$val, tmp$condition, mean)
# tmp_means <- tmp_means[c(1, 2, 4, 3)]
error_vec <- c()
for (i in seq(length(conditions)))
{
er <- sd(filter(tmp, condition==i)$val - tapply(tmp$val, tmp$subject, mean) / sqrt(n_subj))
error_vec <- c(error_vec, er)
}
# error_vec <- error_vec[c(1, 2, 4, 3)]
# ylim <- c(0, 1.21 * max(tmp_means + error_vec))
ylim <- c(0, max(tmp_means + error_vec))
# ab = barplot(tmp_means, beside = TRUE, ylim = ylim, ylab = "Avg. Global Connectivity")
ab = barplot(tmp_means, beside = TRUE, ylim = ylim)
segments(x0 = ab, x1 = ab, y0 = tmp_means, y1 = tmp_means + error_vec)
segments(x0 = ab - .2, x1 = ab + .2, y0 = tmp_means + error_vec, y1 = tmp_means + error_vec)
title(paste("Cluster",cl))
}
for (cl in clusters)
{
tmp <- filter(nn, cluster==cl)
tmp_means <- tapply(tmp$val, tmp$condition, mean)
# tmp_means <- tmp_means[c(1, 2, 4, 3)]
error_vec <- c()
for (i in seq(length(conditions)))
{
er <- sd(filter(tmp, condition==i)$val - tapply(tmp$val, tmp$subject, mean) / sqrt(n_subj))
error_vec <- c(error_vec, er)
}
# error_vec <- error_vec[c(1, 2, 4, 3)]
ylim <- c(0, 1.21 * max(tmp_means + error_vec))
# ab = barplot(tmp_means, beside = TRUE, ylim = ylim, ylab = "Avg. Global Connectivity")
ab = barplot(tmp_means, beside = TRUE, ylim = ylim)
segments(x0 = ab, x1 = ab, y0 = tmp_means, y1 = tmp_means + error_vec)
segments(x0 = ab - .2, x1 = ab + .2, y0 = tmp_means + error_vec, y1 = tmp_means + error_vec)
title(paste("Cluster",cl))
}
source('~/Documents/workspace/hel-con/clusters_barplots.R', echo=TRUE)
tmp_means
q()
getwd()
setwd('/Users/andric/Documents/workspace/hel/group_global_connectivity/')
library(clue)
ls()
8803089 / 2967
?cl_ensemble
ag <- read.table('group_Clust_msk_glob_conn_knnward_clst1')
summary(ag)
dim(rowSums(ag))
length(rowSums(ag))
rm(list=ls())
setwd('/Users/andric/Documents/workspace/hel/group_global_connectivity/')
library(clue)
clst_prts <- read.table('group_Clust_msk_glob_conn_knnward_clst1')
clst_rows <- rowSums(clst_prts)
length(which(clst_rows > 0))
dim(clst_prts[which(clst_rows > 0), ])
clst_prts <- clst_prts[which(clst_rows > 0), ]
dim(clst_prts)
cl_en <- cl_ensemble(clst_prts)
hclust(clst_prts)
length(which(clst_prts == 0))
?as.dist
?hclust
?el_ensemble
dist(clst_prts)
hclust(as.dist(clst_prts))
hclust(dist(clst_prts))
hclust(dist(clst_prts, method = 'ward.D'))
hclust(dist(clst_prts, method = 'ward.D2'))
hclust(dist(clst_prts, method = 'single'))
hclust(dist(clst_prts), method = 'ward.D')
?dist
hclust(dist(clst_prts), method = 'ward.D2')
summary(hclust(dist(clst_prts), method = 'ward.D2'))
cl_ensemble(hclust(dist(clst_prts), method = 'ward.D2'))
summary(cl_ensemble(hclust(dist(clst_prts), method = 'ward.D2')))
?cl_agreement
cl_agreement(clst_prts)
as.cl_ensemble(clst_prts)
summary(clst_prts)
hclust(dist(clst_prts), method = 'ward.D2')
summary(hclust(dist(clst_prts), method = 'ward.D2'))
hclust(dist(clst_prts), method = 'ward.D2')
hclust(dist(clst_prts), method = 'ward.D2')$labels
length(hclust(dist(clst_prts), method = 'ward.D2')$labels)
summary(hclust(dist(clst_prts), method = 'ward.D2'))
hclust(dist(clst_prts), method = 'ward.D2')$order
summary(hclust(dist(clst_prts), method = 'ward.D2'))
str(hclust(dist(clst_prts), method = 'ward.D2'))
cl_ensemble(hclust(dist(clst_prts), method = 'ward.D2'))
str(cl_ensemble(hclust(dist(clst_prts), method = 'ward.D2')))
summary(cl_ensemble(hclust(dist(clst_prts), method = 'ward.D2')))
cl_consensus(hclust(dist(clst_prts), method = 'ward.D2'))
clcon <- cl_consensus(hclust(dist(clst_prts), method = 'ward.D2'))
summary(clcon)
str(clcon)
4720410/262245
summary(cl_agreement(clst_prts))
clcon[1]
summary(as.numeric(clcon[1]))
summary(clcon[1])
length(clcon)
length(clcon[1])
?dist
length(clcon[1])
length(clcon[2])
str(clcon[2])
str(clcon[1])
summary(clcon[1])
?cl_consensus
length(as.numeric(clcon[1]))
cl_ensem <- cl_ensemble(hclust(dist(clst_prts), method = 'ward.D2'))
summary(cl_ensem)
str(cl_ensem)
cl_ensem$labels
cl_ensem
cons_ensem <- cl_consensu(cl_ensem)
cons_ensem <- cl_consensus(cl_ensem)
summmary(cons_ensem)
summary(cons_ensem)
length(as.numeric((cons_ensem)[1]))
min(as.numeric((cons_ensem)[1]))
cons_ensem
cons_ensem[1]
length(cons_ensem[1])
summary(cons_ensem[1])
cl_ensem <- cl_ensemble(hclust(as.dist(clst_prts), method = 'ward.D2'))
8803089 / 2967
summary(ag)
ag <- read.table('agreement_group_Clust_msk_glob_conn_knnward_clst1')
cl_agensem <- cl_ensemble(hclust(as.dist(ag), method = 'ward.D2'))
ag_cons <- cl_consensus(cl_agensem)
summary(ag_cons)
summary(ag_cons[1])
summary(as.numeric(ag_cons[1]))
str(as.numeric(ag_cons[1]))
str(ag_cons[1])
length(ag_cons[1])
length(ag_cons[1][1])
length(ag_cons$.Data)
length(ag_cons$.Data[1])
length(ag_cons$.Data[1][1])
summary(ag_cons$.Data[1])
summary(ag_cons$.Data[1]$V2967)
summary(ag_cons$.Data[1][2967])
length(ag_cons$.Data[1][2967])
ag_cons$.Data[1][2967]
ag_cons$.Data[1][2966]
length(unique(ag_cons$.Data[1]))
unique(ag_cons$.Data[1])
?cl_ensemble
?hclust
?as.dist
?hclust
?cl_ensemble
setwd('/Users/andric/Documents/workspace/hel/group_global_connectivity/')
library(clue)
ag <- read.table('agreement_group_Clust_msk_glob_conn_knnward_clst1')
cl_agensem <- cl_ensemble(hclust(as.dist(ag), method = 'ward.D2'))
ag_cons <- cl_consensus(cl_agensem)
summary(ag_cons)
length(ag_cons[[1]])
min(ag_cons[[1]])
max(ag_cons[[1]])
?cl_consensus
unique(ag_cons[[1]])
length(unique(ag_cons[[1]]))
8803089 / 2967
2967**2
length(unique(ag_cons[[1]]))
length(ag_cons[[1]])
4400061 / 2967
dim(ag)
length(ag)
length(c(ag))
length(c(as.matrix(ag)))
length(c(as.matrix(ag[ag != 0])))
8705148 / 2967
8705148 / 3300061
8705148 / 4400061
summary(cl_agensem)
str(cl_agensem)
cl_agensem[[1]]
cl_agensem[[2]]
cl_agensem[1
]
cl_agensem[1]
cl_agensem[[1]]
cl_agensem
cl_agensem[[1]]
cl_agensem[[1]][1]
dim(cl_agensem[[1]][1])
length(cl_agensem[[1]][1])
cl_agensem[[1]][,1]
dim(cl_agensem[[1]])
str(cl_agensem[[1]])
str(cl_agensem)
summary(cl_agensem[1])
summary(cl_agensem[[1]])
summary(cl_agensem$merge)
summary(cl_agensem$height)
summary(cl_agensem[[1]]$height)
summary(cl_agensem[[1]]$labels)
length(cl_agensem[[1]]$labels)
cl_agensem[[1]]$labels[1]
cl_agensem[[1]]$labels[2]
cl_agensem[[1]]$labels
cl_agensem[[2]]$labels
cl_agensem$labels
?cl_ensemble
d <- dist(USArrests)
hclust_methods <-
c("ward", "single", "complete", "average", "mcquitty")
hclust_results <- lapply(hclust_methods, function(m) hclust(d, m))
hclust_results
hclust_results[[5]]
summary(hclust_results[[5]])
names(hclust_results) <- hclust_methods
hclust_results
summary(hclust_results[[5]])
summary(hclust_results$mcquitty)
hens <- cl_ensemble(list = hclust_results)
hens
hens[1 : 3]
rep(hens, 3)
plot(hens, main = names(hens))
round(cl_dissimilarity(hens, method = "gamma"), 4)
d
dim(d)
length(d)
str(d)
clst_prts <- read.table('group_Clust_msk_glob_conn_knnward_clst1')
dim(clst_prts)
clst_rows <- rowSums(clst_prts)
clst_prts <- clst_prts[which(clst_rows > 0), ]
dim(clst_prts)
as.cl_ensemble(clst_prts)
is.cl_ensemble(clst_prts)
(2967*2966) / 2
?cl_consensus
summary(ag_cons)
summary(ag_cons[[1]])
ag_cons[[1]][1]
length(ag_cons[[1]][1])
length(ag_cons[[1]])
length(ag_cons[[1]][3000])
length(ag_cons[[1]][3])
length(ag_cons[[1]][2966])
length(ag_cons[[1]][2967])
length(ag_cons[[1]][2967])
length(ag_cons[[1]][2968])
length(ag_cons[[1]][2967])
summary(ag_cons[[1]][2967])
length(unique(ag_cons[[1]][2967]))
unique(ag_cons[[1]][2967])
summary(cl_agensem)
summary(cl_agensem[1])
cl_agensem
plot(cl_agensem)
q()
ag <- read.table('agreement_group_Clust_msk_glob_conn_knnward_clst1')
setwd('/Users/andric/Documents/workspace/hel/group_global_connectivity/')
library(clue)
ag <- read.table('agreement_group_Clust_msk_glob_conn_knnward_clst1')
dim(ag)
clst_prts <- read.table('group_Clust_msk_glob_conn_knnward_clst1')
clst_rows <- rowSums(clst_prts)
clst_prts <- clst_prts[which(clst_rows > 0), ]
dim(clst_prts)
?hclust
?as.dist
d <- as.dist(ag)
dim(d)
length(d)
unique(d)
d <- as.dist(ag, method='canberra')
d <- as.dist(ag, method='canberra')
d <- as.dist(ag, method="canberra")
d <- dist(ag, method="canberra")
dim(d)
length(d)
d[1]
d[2]
?hclust
?save
?hclust
d_cl <- hclust(d, method='ward.D2')
summary(d_cl)
d_cl$labels
length(d)
d[1:20]
d_cl$method
d_cl <- hclust(d, method='ward')
d_cl <- hclust(d, method='ward.D')
d_cl$labels
d_cl$dist.method
?dist
d[4400060]
d[4400061]
d[4400062]
d[4400063]
d_cl <- hclust(d)
d_cl
summary(d_cl)
plot(d_cl)
d_cl <- hclust(d, method='ward.D2')
d_cl
plot(d_cl)
?hclust
str(d_cl)
summary(d_cl)
length(unique(d_cl$order))
length(unique(d_cl$height))
length(unique(d_cl$merge))
d_cl$merge[1:20]
d_cl$order[1:20]
d_cl$call
d_cl$height[1:20]
length(unique(d_cl$height))
length(d_cl$height)
max(d_cl$height)
sort(d_cl$height)[1:10]
sort(d_cl$height, descending=TRUE)[1:10]
sort(d_cl$height, decreasing=TRUE)[1:10]
?dist
plot(d_cl)
hclust
?hclust
rect.hclust(d_cl, k=5)
?rect.hclust
rect_d_cl <- rect.hclust(d_cl, k=4)
plot(d_cl)
rect_d_cl <- rect.hclust(d_cl, k=4)
summary(rect_d_cl)
length(rect_d_cl)
dim(rect_d_cl)
length(rect_d_cl[1])
length(rect_d_cl[[1]])
rect_d_cl
?cutree
ctree <- cutree(d_cl, k=4)
length(ctree)
ctree[1:10]
summary(rect_d)
summary(rect_d_cll)
summary(rect_d_cl)
km <- kmeans(d_cl, 4)
length(km)
summary(km)
summary(km$cluster)
km$clust[1:10]
km$clust[1]
km$clust[20:40]
ctree[1:10]
?kmeans
summary(d)
length(d)
str(d)
d[1]
d
km$clust[20:30]
length(km$clust)
length(clst_rows)
length(which(clst_rows > 0))
which(clst_rows > 0)[1:20]
dim(AG)
dim(ag)
dim(clst_prts)
dim(clst_rows)
length(clst_rows)
length(km$cluster)
km$cluster[30:60]
solution_vec <- rep(0, length(clst_rows))
solution_vec[which(clst_rows > 0)] = km$cluster
length(which(solution_vec > 0))
getwd()
write.table(solution_vec, 'kmeans_group_clst', row.names=F, col.names=F, quote=F)
dim(rect_d_cl)
length(rect_d_cl)
length(rect_d_cl[1])
length(rect_d_cl[[1]])
length(rect_d_cl[[2]])
length(rect_d_cl[[3]])
length(rect_d_cl[[4]])
rect_d_cl[[1]][1:10]
ctree[1:10]
rect_d_cl[[1]][290:298]
ctree[290:298]
length(which(ctree == 1))
length(which(ctree == 2))
length(which(ctree == 3))
length(which(ctree == 4))
ctree[1:10]
which(ctree == 1)[1:10]
rect_d_cl[[4]][1:10]
rect_d_cl[290:300]
rect_d_cl[[1]][290:300]
length(ctree)
solution_vec <- rep(0, length(clst_rows))
solution_vec[which(clst_rows > 0)] = ctree
write.table(solution_vec, 'wrd_group_clst', row.names=F, col.names=F, quote=F)
length(clst_prts)
length(clst_rows)
1048980 / 262245
