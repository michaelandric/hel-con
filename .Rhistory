for (viewing in colnames(q_vals)){
corrtest <- cor.test(get(levl), get(viewing))
if (corrtest$p.value <= .05){
print(c(td, levl, viewing))
print(corrtest)
}
else{
next
}
}
}
detach(q_vals)
}
list(td, levl)
list(c(td, levl))
list(c(td, levl))[[1]]
c(td, levl)
get(levl)
for (levl in c('lh_highlev', 'lh_lowlev')){
corrtest <- cor.test(get(levl), scores)
if (corrtest$p.value <= .05){
print(c(levl))
}
else{
next
}
}
for (levl in c('lh_highlev', 'lh_lowlev')){
corrtest <- cor.test(get(levl), scores)
if (corrtest$p.value <= .05){
print(c(levl))
print(corrtest)
}
else{
next
}
}
cor.test(get(levl), get(viewing))
attach(q_vals)
cor.test(get(levl), get(viewing))
length(get(viewing))
summary(get(viewing))
sd(get(viewing))
rnorm(18, mean=.25)
cor.test(get(levl), rnorm(18, mean=.25))
cor.test(get(levl), rnorm(18, mean=.25))
cor.test(get(levl), rnorm(18, mean=.25))
cor.test(get(levl), rchisq(18, mean=.25))
a
?rchisq
rchiq(18, 1)
rchisq(18, 1)
a <- rchisq(18, 1)
cor.test(get(levl), rnorm(18, mean=.25))
cor.test(get(levl), a)
cor.test(get(levl), rchisq(18, 1))
cor.test(get(levl), rchisq(18, 2))
cor.test(get(levl), rchisq(18, 17))
cor.test(get(levl), rchisq(18, 17))
filter(region_frame, Region=='lh_ttg'
)
filter(region_frame, Region=='lh_ttg')
filter(region_frame, Region=='lh_ttg')$NZMean
levl
cor.test(lh_lowlev, filter(region_frame, Region=='lh_ttg')$NZMean)
cor.test(lh_lowlev, filter(region_frame, Region=='rh_ttg')$NZMean)
cor.test(lh_lowlev, filter(region_frame, Region=='rh_IFGOp')$NZMean)
cor.test(lh_lowlev, filter(region_frame, Region=='rh_ant_occ_s')$NZMean)
cor.test(lh_lowlev, filter(region_frame, Region=='lh_sup_temp_g')$NZMean)
cor.test(lh_lowlev, filter(region_frame, Region=='lh_mid_occ_g')$NZMean)
cor.test(lh_lowlev, filter(region_frame, Region=='lh_vis_ctx')$NZMean)
cor.test(lh_lowlev, filter(region_frame, Region=='lh_planum_tem')$NZMean)
cor.test(scores, filter(region_frame, Region=='lh_planum_tem')$NZMean)
cor.test(lh_highlev, filter(region_frame, Region=='lh_planum_tem')$NZMean)
filter(region_frame, Region=='lh_ttg')
mean(filter(region_frame, Region=='lh_ttg')$NZMean)
mean(filter(region_frame, Region=='lh_ant_occ_s')$NZMean)
print(sort(tapply(region_frame$NZMean, list(region_frame$Region), sd)))
print(sort(tapply(region_frame$NZMean, list(region_frame$Region), mean)))
filter(region_frame, Region=='lh_sup_temp_s')
lh_ant_occ_s_dat
filter(region_frame, Region=='lh_sup_temp_s')$NZMean
cor.test(filter(region_frame, Region=='lh_sup_temp_s')$NZMean, filter(region_frame, Region=='lh_ant_occ_s')$NZMean)
mean(filter(region_frame, Region=='lh_ttg')$NZMean)
filter(region_frame, Region=='lh_ttg')
qqnorm(scores)
qqnorm(filter(region_frame, Region=='lh_ttg')$NZMean)
qqnorm(filter(region_frame, Region=='lh_ant_occ_s')$NZMean)
print(sort(tapply(region_frame$NZMean, list(region_frame$Region), sd)))
print(sort(tapply(region_frame$NZMean, list(region_frame$Region), mean)))
cor.test(filter(region_frame, Region=='lh_ttg')$NZMean, filter(region_frame, Region=='lh_vis_ctx')$NZMean)
filter(region_frame, Region=='lh_ttg')$NZMean
write.table(filter(region_frame, Region=='lh_ttg')$NZMean, 'lh_ttg.txt',
row.names=F, col.names=F, quote=F)
write.table(filter(region_frame, Region=='lh_vis_ctx')$NZMean, 'lh_vis_ctx.txt',
row.names=F, col.names=F, quote=F)
?atanh
atanh(0.785795)
tanh(0.785795)
atanh(0.785795)
?qnorm
qt((1-.05)/2, 16)
qt((1-.05)/2, 2)
qt((1-.05/2), 2)
qt((1-.05/2), 16)
qt((1-.05/2), 18)
qt((1-.01/2), 18)
qt((1-.01/2), 17)
qt((1-.01), 17)
qt((1-.01/2), 17)
qt((1-.001/2), 17)
qt((1-.01/2), 17)
qt((1-.01), 17)
cor.test(filter(region_frame, Region=='lh_ttg')$NZMean, filter(region_frame, Region=='lh_vis_ctx')$NZMean)
cor.test(scores, filter(region_frame, Region=='lh_vis_ctx')$NZMean)
cor.test(q_vals$View1, filter(region_frame, Region=='lh_vis_ctx')$NZMean)
cor.test(q_vals$View2, filter(region_frame, Region=='lh_vis_ctx')$NZMean)
?qnorm
qqnorm(filter(region_frame, Region=='lh_ant_occ_s')$NZMean)
library(ggplot2)
qplot(sample=filter(region_frame, Region=='lh_ant_occ_s')$NZMean)
qplot(sample=filter(region_frame, Region=='lh_ant_occ_s')$NZMean) + theme_bw()
qplot(sample=filter(region_frame, Region=='lh_ant_occ_s')$NZMean, main=paste('Q-Q plot lh_ant_occ_s')) + theme_bw()
qplot(sample=filter(region_frame, Region=='lh_ant_occ_s')$NZMean)
qqnorm(filter(region_frame, Region=='lh_ant_occ_s')$NZMean)
qplot(sample=filter(region_frame, Region=='lh_ant_occ_s')$NZMean, main=paste('Q-Q plot lh_ant_occ_s')) + theme_bw()
qplot(sample=filter(region_frame, Region=='lh_ant_occ_s')$NZMean,
main=paste('Q-Q plot lh_ant_occ_s')) + theme_bw() + geom_point(size=3)
qplot(sample=filter(region_frame, Region=='lh_ant_occ_s')$NZMean,
main=paste('Q-Q plot lh_ant_occ_s'), size=3) + theme_bw()
qplot(sample=filter(region_frame, Region=='lh_ant_occ_s')$NZMean,
main=paste('Q-Q plot lh_ant_occ_s')) + theme_bw()
qplot(sample=filter(region_frame, Region=='lh_ant_occ_s')$NZMean,
main=paste('Q-Q plot lh_ant_occ_s')) + theme_bw() + scale_shape_manual(size=3)
qplot(sample=filter(region_frame, Region=='lh_ant_occ_s')$NZMean,
main=paste('Q-Q plot lh_ant_occ_s')) + theme_bw() + scale_shape_manual(values=c(3))
qplot(sample=filter(region_frame, Region=='lh_ant_occ_s')$NZMean,
main=paste('Q-Q plot lh_ant_occ_s')) + theme_bw() + scale_shape_manual(values=c(3,4))
qplot(sample=filter(region_frame, Region=='lh_ant_occ_s')$NZMean,
main=paste('Q-Q plot lh_ant_occ_s')) + theme_bw() + points(cex=3)
qplot(sample=filter(region_frame, Region=='lh_ant_occ_s')$NZMean,
main=paste('Q-Q plot lh_ant_occ_s')) + theme_bw() + geom_point(size=3)
?qplot
qplot(sample=filter(region_frame, Region=='lh_ant_occ_s')$NZMean,
main=paste('Q-Q plot lh_ant_occ_s'), cex=2) + theme_bw()
qplot(sample=filter(region_frame, Region=='lh_ant_occ_s')$NZMean,
main=paste('Q-Q plot lh_ant_occ_s'), cex=10) + theme_bw()
qplot(sample=filter(region_frame, Region=='lh_ant_occ_s')$NZMean,
main=paste('Q-Q plot lh_ant_occ_s'), size=4) + theme_bw()
qplot(sample=filter(region_frame, Region=='lh_ant_occ_s')$NZMean,
main=paste('Q-Q plot lh_ant_occ_s'), size=8) + theme_bw()
ggplot(region_frame, aes(sample=filter(region_frame, Region=='lh_ant_occ_s')$NZMean)) + theme_bw()
ggplot(region_frame, aes(sample=filter(region_frame, Region=='lh_ant_occ_s')$NZMean)) + stat_qq() + theme_bw()
filter(region_frame, Region=='lh_ant_occ_s')
ggplot(filter(region_frame, Region=='lh_ant_occ_s'), aes(sample=NZMean)) + stat_qq() + theme_bw()
ggplot(filter(region_frame, Region=='lh_ant_occ_s'), aes(sample=NZMean)) + stat_qq() + theme_bw() + geom_point(size=5)
ggplot(filter(region_frame, Region=='lh_ant_occ_s'), aes(sample=NZMean)) + stat_qq() + theme_bw() + scale_point(size=5)
?stat_qq
ggplot(filter(region_frame, Region=='lh_ant_occ_s'), aes(sample=NZMean)) + theme_bw() + geom_point(stat='qq', size=5)
ggplot(filter(region_frame, Region=='lh_ant_occ_s'), aes(sample=NZMean)) + theme_bw() + geom_point(stat='qq', size=6)
ggplot(filter(region_frame, Region=='lh_ant_occ_s'), aes(sample=NZMean)) + theme_bw() + geom_point(stat='qq', size=10)
ggplot(filter(region_frame, Region=='lh_ant_occ_s'), aes(sample=NZMean)) + theme_bw() + geom_point(stat='qq', size=3)
ggplot(filter(region_frame, Region=='lh_ant_occ_s'), aes(sample=NZMean)) + theme_bw() + geom_point(stat='qq', size=4)
ggplot(filter(region_frame, Region=='lh_ant_occ_s'), aes(sample=NZMean)) + theme_bw() + geom_point(stat='qq', size=4) + scale_shape(solid=FALSE)
ggplot(filter(region_frame, Region=='lh_ant_occ_s'), aes(sample=NZMean)) +
theme_bw() + geom_point(stat='qq', size=4) + scale_shape(solid=FALSE)
ggplot(filter(region_frame, Region=='lh_ant_occ_s'), aes(sample=NZMean)) +
theme_bw() + geom_point(stat='qq', size=4, shape=3)
ggplot(filter(region_frame, Region=='lh_ant_occ_s'), aes(sample=NZMean)) +
theme_bw() + geom_point(stat='qq', size=4, shape=2)
ggplot(filter(region_frame, Region=='lh_ant_occ_s'), aes(sample=NZMean)) +
theme_bw() + geom_point(stat='qq', size=4, shape=5)
ggplot(filter(region_frame, Region=='lh_ant_occ_s'), aes(sample=NZMean)) +
theme_bw() + geom_point(stat='qq', size=4, shape=1)
ggplot(filter(region_frame, Region=='lh_ant_occ_s'), aes(sample=NZMean)) +
theme_bw() + geom_point(stat='qq', size=4, shape=1) + ggtitle('Q-Q plot lh_ant_occ_s')
ggplot(filter(region_frame, Region=='lh_ant_occ_s'), aes(sample=NZMean)) +
theme_bw() + geom_point(stat='qq', size=4, shape=1) + ggtitle('Q-Q plot lh_ant_occ_s')
ggplot(filter(region_frame, Region=='lh_ttg'), aes(sample=NZMean)) +
theme_bw() + geom_point(stat='qq', size=4, shape=1) + ggtitle('Q-Q plot lh_ttg')
regions
region_list
ggplot(filter(region_frame, Region=='lh_planum_tem'), aes(sample=NZMean)) +
theme_bw() + geom_point(stat='qq', size=4, shape=1) + ggtitle('Q-Q plot lh_planum_tem')
ggplot(filter(region_frame, Region=='lh_ant_occ_s'), aes(sample=NZMean)) +
theme_bw() + geom_point(stat='qq', size=4) + ggtitle('Q-Q plot lh_ant_occ_s')
pdf('region_qqplots.pdf')
ggplot(filter(region_frame, Region=='lh_ant_occ_s'), aes(sample=NZMean)) +
theme_bw() + geom_point(stat='qq', size=4) + ggtitle('Q-Q plot lh_ant_occ_s')
ggplot(filter(region_frame, Region=='lh_ttg'), aes(sample=NZMean)) +
theme_bw() + geom_point(stat='qq', size=4) + ggtitle('Q-Q plot lh_ttg')
ggplot(filter(region_frame, Region=='lh_planum_tem'), aes(sample=NZMean)) +
theme_bw() + geom_point(stat='qq', size=4) + ggtitle('Q-Q plot lh_planum_tem')
dev.off()
ggplot(filter(region_frame, Region=='lh_sup_temp_s'), aes(sample=NZMean)) +
theme_bw() + geom_point(stat='qq', size=4) + ggtitle('Q-Q plot lh_sup_temp_s')
pdf('region_qqplots.pdf')
ggplot(filter(region_frame, Region=='lh_ant_occ_s'), aes(sample=NZMean)) +
theme_bw() + geom_point(stat='qq', size=4) + ggtitle('Q-Q plot lh_ant_occ_s')
ggplot(filter(region_frame, Region=='lh_ttg'), aes(sample=NZMean)) +
theme_bw() + geom_point(stat='qq', size=4) + ggtitle('Q-Q plot lh_ttg')
ggplot(filter(region_frame, Region=='lh_planum_tem'), aes(sample=NZMean)) +
theme_bw() + geom_point(stat='qq', size=4) + ggtitle('Q-Q plot lh_planum_tem')
ggplot(filter(region_frame, Region=='lh_vis_ctx'), aes(sample=NZMean)) +
theme_bw() + geom_point(stat='qq', size=4) + ggtitle('Q-Q plot lh_vix_ctx')
ggplot(filter(region_frame, Region=='lh_sup_temp_s'), aes(sample=NZMean)) +
theme_bw() + geom_point(stat='qq', size=4) + ggtitle('Q-Q plot lh_sup_temp_s')
dev.off()
filter(region_frame, Region=='lh_ant_occ_s')
max(filter(region_frame, Region=='lh_ant_occ_s')$NZMean)
sd(filter(region_frame, Region=='lh_ant_occ_s')$NZMean)
print(sort(tapply(region_frame$NZMean, list(region_frame$Region), sd)))
print(sort(tapply(region_frame$NZMean, list(region_frame$Region), mean)))
print(sort(tapply(region_frame$NZMean, list(region_frame$Region), max)))
cor.test(filter(region_frame, Region=='lh_vis_ctx')$NZMean, filter(region_frame, Region=='lh_ttg')$NZMean)
cor.test(filter(region_frame, Region=='lh_planum_tem')$NZMean, filter(region_frame, Region=='lh_ttg')$NZMean)
cor.test(filter(region_frame, Region=='lh_mid_occ_g')$NZMean, filter(region_frame, Region=='lh_ttg')$NZMean)
cor.test(filter(region_frame, Region=='lh_mid_occ_g')$NZMean, filter(region_frame, Region=='lh_vis_ctx')$NZMean)
scores
scores_frame
ggplot(scores_frame, aes(sample=scores)) + theme_bw() + geom_point(stat='qq', size=4)
ggplot(scores_frame, aes(sample=scores)) + theme_bw() +
geom_point(stat='qq', size=4) + ggtitle('Q-Q plot scores')
pdf('region_qqplots.pdf')
ggplot(filter(region_frame, Region=='lh_ant_occ_s'), aes(sample=NZMean)) +
theme_bw() + geom_point(stat='qq', size=4) + ggtitle('Q-Q plot lh_ant_occ_s')
ggplot(filter(region_frame, Region=='lh_ttg'), aes(sample=NZMean)) +
theme_bw() + geom_point(stat='qq', size=4) + ggtitle('Q-Q plot lh_ttg')
ggplot(filter(region_frame, Region=='lh_planum_tem'), aes(sample=NZMean)) +
theme_bw() + geom_point(stat='qq', size=4) + ggtitle('Q-Q plot lh_planum_tem')
ggplot(filter(region_frame, Region=='lh_vis_ctx'), aes(sample=NZMean)) +
theme_bw() + geom_point(stat='qq', size=4) + ggtitle('Q-Q plot lh_vix_ctx')
ggplot(filter(region_frame, Region=='lh_sup_temp_s'), aes(sample=NZMean)) +
theme_bw() + geom_point(stat='qq', size=4) + ggtitle('Q-Q plot lh_sup_temp_s')
ggplot(scores_frame, aes(sample=scores)) + theme_bw() +
geom_point(stat='qq', size=4) + ggtitle('Q-Q plot scores')
dev.off()
a = sample(rnorm(20))
b = sample(rnorm(20))
cor.test(a, b)
cor.test(a, (b*-1)
)
a
b
b*-1
cor.test(a, b)
cor.test(a, (b*-1))
filter(region_frame, Region=='lh_vis_ctx')
cor.test(filter(region_frame, Region=='lh_mid_occ_g')$NZMean, filter(region_frame, Region=='lh_vis_ctx')$NZMean)
cor.test(filter(region_frame, Region=='lh_mid_occ_g')$NZMean, filter(region_frame, Region=='lh_ttg')$NZMean)
cor.test(filter(region_frame, Region=='lh_mid_occ_g')$NZMean, filter(region_frame, Region=='lh_ant_occ_s')$NZMean)
.111297 - .120281
q()
setwd('/Users/andric/Documents/workspace/hel/behav_correlations_etc/')
peak_diff_dat <- read.csv('avg_corrZ_task_diff_peak_voxel_data.csv')
library(dplyr)
library(ggplot2)
library(gridExtra)
library(reshape2)
intrasubj_corr_dat <- read.csv('tcorr_prsn_gm_mskd_Z_peak_voxel_data.csv')
dim(intrasubj_corr_dat)
dim(peak_diff_dat)
melt(peak_diff_dat)
summary(melt(peak_diff_dat))
summary(melt(intrasubj_corr_dat))
str(melt(intrasubj_corr_dat))
factor(melt(intrasubj_corr_dat))
melt(intrasubj_corr_dat)$variable
levels(melt(intrasubj_corr_dat)$variable)
levels(melt(peak_diff_dat)$variable)
clusters <- levels(melt(peak_diff_dat)$variable)
plots <- list()
plt_cnt = 0
clusters
peak_diff_dat
rbind(peak_diff_dat, intrasubj_corr_dat)
tail(intrasubj_corr_dat)
head(peak_v)
head(peak_diff_dat)
melt(rbind(peak_diff_dat, intrasubj_corr_dat))
rbind(peak_diff_dat, intrasubj_corr_dat)
dim(peak_diff_dat)
rep('diff_wgc', dim(peak_diff_dat)[1])
rep('intrasubj_corr', dim(intrasubj_corr_dat)[1])
rep('intrasubj_corr', dim(intrasubj_corr_dat)[1])
c(rep('diff_wgc', dim(peak_diff_dat)[1]), rep('intrasubj_corr', dim(intrasubj_corr_dat)[1]))
data.frame(rbind(peak_diff_dat, intrasubj_corr_dat))
data.frame(rbind(peak_diff_dat, intrasubj_corr_dat), label_vec)
label_vec <- c(rep('diff_wgc', dim(peak_diff_dat)[1]),
rep('intrasubj_corr', dim(intrasubj_corr_dat)[1]))
data.frame(rbind(peak_diff_dat, intrasubj_corr_dat), label_vec)
melt(data.frame(rbind(peak_diff_dat, intrasubj_corr_dat), label_vec))
df_peak_intrasubj <- melt(data.frame(rbind(peak_diff_dat, intrasubj_corr_dat),
label_vec))
summary(df_peak_intrasubj)
df_peak_intrasubj
df_peak_intrasubj <- tbl_df(df_peak_intrasubj)
df_peak_intrasubj
df_peak_intrasubj <- data.frame(rbind(peak_diff_dat, intrasubj_corr_dat),
label_vec)
df_peak_intrasubj <- tbl_df(df_peak_intrasubj)
df_peak_intrasubj
ggplot(df_peak_intrasubj, aes(label_vec, lh_vis_ctx_0))
ggplot(df_peak_intrasubj, aes(label_vec, lh_vis_ctx_0)) + geom_point(size = 3)
ggplot(df_peak_intrasubj, aes_string(label_vec, lh_vis_ctx_0)) + geom_point(size = 3)
ggplot(df_peak_intrasubj, aes_string(x=diff_wgc, y=intrasubj_corr)) + geom_point(size = 3)
ggplot(df_peak_intrasubj, aes(x=diff_wgc, y=intrasubj_corr)) + geom_point(size = 3)
melt(peak_diff_dat)
mlt_peak_diff <- melt(peak_diff_dat)
mlt_intrasubj <- melt(intrasubj_corr_dat)
mlt_intrasubj
mlt_peak_diff
data.frame(mlt_peak_diff, mlt_intrasubj$value)
df_peak_intrasubj <- data.frame(mlt_peak_diff, mlt_intrasubj$value)
df_peak_intrasubj <- tbl_df(df_peak_intrasubj)
names(df_peak_intrasubj) <- c('clust', 'diff_wgc', 'intra_subj_cor')
summary(df_peak_intrasubj)
ggplot(df_peak_intrasubj, aes(x=diff_wgc, y=intra_subj_cor)) + geom_point(size = 3)
ggplot(filter(df_peak_intrasubj, clust=='lh_vis_ctx_0', aes(x=diff_wgc, y=intra_subj_cor)) + geom_point(size = 3)
)
ggplot(filter(df_peak_intrasubj, clust=='lh_vis_ctx_0'), aes(x=diff_wgc, y=intra_subj_cor)) + geom_point(size = 3)
ggplot(filter(df_peak_intrasubj, clust=='lh_vis_ctx_0'), aes(x=diff_wgc, y=intra_subj_cor)) + geom_point(size = 3) + geom_smooth(method=lm, se=FALSE, size=1.15) + theme_bw()
df_peak_intrasubj
tbl_df(df_peak_intrasubj)
df_peak_intrasubj$clust
level(df_peak_intrasubj$clust)
levels(df_peak_intrasubj$clust)
levels(df_peak_intrasubj$clust)[1]
ScatterPlot <- function(x) {
# This takes only the cluster name (e.g., 'lh_vis_ctx_0')
# of the data frame "df_peak_intrasubj"
ggplot(filter(df_peak_intrasubj, clust==x),
aes(x=diff_wgc, y=intra_subj_cor)) + geom_point(size = 3)
+ geom_smooth(method=lm, se=FALSE, size=1.15) + theme_bw()
}
for (clstr in levels(df_peak_intrasubj$clust)[1]) {
ScatterPlot(clstr)
}
clstr
filter(df_peak_intrasubj, clust==clstr)
ggplot(filter(df_peak_intrasubj, clust==x),
aes(x=diff_wgc, y=intra_subj_cor)) + geom_point(size = 3)
ggplot(filter(df_peak_intrasubj, clust==clstr),
aes(x=diff_wgc, y=intra_subj_cor)) + geom_point(size = 3)
ggplot(filter(df_peak_intrasubj, clust==clstr),
aes(x=diff_wgc, y=intra_subj_cor)) + geom_point(size = 3) + geom_smooth(method=lm, se=FALSE, size=1.15) + theme_bw()
ScatterPlot <- function(x) {
# This takes only the cluster name (e.g., 'lh_vis_ctx_0')
# of the data frame "df_peak_intrasubj"
ggplot(filter(df_peak_intrasubj, clust==x),
aes(x=diff_wgc, y=intra_subj_cor))
+ geom_point(size = 3) + geom_smooth(method=lm, se=FALSE, size=1.15)
+ theme_bw()
}
for (clstr in levels(df_peak_intrasubj$clust)[1]) {
ScatterPlot(clstr)
}
ggplot(filter(df_peak_intrasubj, clust==x),
aes(x=diff_wgc, y=intra_subj_cor))
+ geom_point(size = 3) + geom_smooth(method=lm, se=FALSE, size=1.15)
+ theme_bw()
ggplot(filter(df_peak_intrasubj, clust==clstr),
aes(x=diff_wgc, y=intra_subj_cor))
+ geom_point(size = 3) + geom_smooth(method=lm, se=FALSE, size=1.15)
+ theme_bw()
ggplot(filter(df_peak_intrasubj, clust==x),
aes(x=diff_wgc, y=intra_subj_cor)) + geom_point(size = 3) +
geom_smooth(method=lm, se=FALSE, size=1.15) + theme_bw()
ggplot(filter(df_peak_intrasubj, clust==clstr),
aes(x=diff_wgc, y=intra_subj_cor)) + geom_point(size = 3) +
geom_smooth(method=lm, se=FALSE, size=1.15) + theme_bw()
ScatterPlot <- function(x) {
# This takes only the cluster name (e.g., 'lh_vis_ctx_0')
# of the data frame "df_peak_intrasubj"
ggplot(filter(df_peak_intrasubj, clust==x),
aes(x=diff_wgc, y=intra_subj_cor)) + geom_point(size = 3) +
geom_smooth(method=lm, se=FALSE, size=1.15) + theme_bw()
}
for (clstr in levels(df_peak_intrasubj$clust)[1]) {
ScatterPlot(clstr)
}
ScatterPlot <- function(x) {
# This takes only the cluster name (e.g., 'lh_vis_ctx_0')
# of the data frame "df_peak_intrasubj"
ggplot(filter(df_peak_intrasubj, clust==x),
aes(x=diff_wgc, y=intra_subj_cor)) + geom_point(size = 3) +
geom_smooth(method=lm, se=FALSE, size=1.15) + theme_bw() +
ggtitle(paste(x))
}
for (clstr in levels(df_peak_intrasubj$clust)[1]) {
ScatterPlot(clstr)
}
plots <- list()
plt_cnt = 0
for (clstr in levels(df_peak_intrasubj$clust)[1]) {
plt_cnt = plt_cnt + 1
plt <- ScatterPlot(clstr)
plots[[plt_cnt]] <- plt  # add each plot into plot list
print(plt)
}
source('~/Documents/workspace/hel-con/peak_voxel_scatterplots.R', echo=TRUE)
for (clstr in levels(df_peak_intrasubj$clust)[1]) { print(clstr) }
for (clstr in levels(df_peak_intrasubj$clust)) { print(clstr) }
filter(df_peak_intrasubj, clust==clstr)
names(df_peak_intrasubj)
names(df_peak_intrasubj)[2]
ScatterPlot <- function(df, xname, yname, title_name) {
# This takes only the cluster name (e.g., 'lh_vis_ctx_0')
# of the data frame "df_peak_intrasubj"
# works off 3 column data frame, with variable name in one column and
# values in each the other two columns (those are the "x" and "y" in plot).
ggplot(df, aes(x=xname, y=yname)) + geom_point(size = 3) +
geom_smooth(method=lm, se=FALSE, size=1.15) + theme_bw() +
ggtitle(paste(title_name))
}
for (clstr in levels(df_peak_intrasubj$clust)) {
plt_cnt = plt_cnt + 1
#plt <- ScatterPlot(clstr)
plt <- ScatterPlot(filter(df_peak_intrasubj, clust==clstr),
names(df_peak_intrasubj)[2], names(df_peak_intrasubj)[3],
clstr)
plots[[plt_cnt]] <- plt  # add each plot into plot list
print(plt)
}
names(df_peak_intrasubj)[2]
ScatterPlot <- function(df, xname, yname, title_name) {
# This takes only the cluster name (e.g., 'lh_vis_ctx_0')
# of the data frame "df_peak_intrasubj"
# works off 3 column data frame, with variable name in one column and
# values in each the other two columns (those are the "x" and "y" in plot).
ggplot(df, aes(x=xname, y=yname)) + geom_point(size = 3) +
geom_smooth(method=lm, se=FALSE, size=1.15) + theme_bw() +
ggtitle(paste(title_name))
}
plt <- ScatterPlot(filter(df_peak_intrasubj, clust==clstr),
names(df_peak_intrasubj)[2], names(df_peak_intrasubj)[3],
clstr)
print(plt)
ScatterPlot <- function(df, xname, yname, title_name) {
# This takes only the cluster name (e.g., 'lh_vis_ctx_0')
# of the data frame "df_peak_intrasubj"
# works off 3 column data frame, with variable name in one column and
# values in each the other two columns (those are the "x" and "y" in plot).
ggplot(df, aes_string(x=xname, y=yname)) + geom_point(size = 3) +
geom_smooth(method=lm, se=FALSE, size=1.15) + theme_bw() +
ggtitle(paste(title_name))
}
for (clstr in levels(df_peak_intrasubj$clust)) {
plt_cnt = plt_cnt + 1
#plt <- ScatterPlot(clstr)
plt <- ScatterPlot(filter(df_peak_intrasubj, clust==clstr),
names(df_peak_intrasubj)[2], names(df_peak_intrasubj)[3],
clstr)
plots[[plt_cnt]] <- plt  # add each plot into plot list
print(plt)
}
source('~/Documents/workspace/hel-con/peak_voxel_scatterplots.R', echo=TRUE)
df_peak_intrasubj
filter(df_peak_intrasubj, clust=='lh_highlevel_0')
filter(df_peak_intrasubj, clust=='lh_highlevel_1')
filter(df_peak_intrasubj, clust=='lh_vis_ctx_2')
filter(df_peak_intrasubj, clust=='lh_vis_ctx_1')
filter(df_peak_intrasubj, clust=='lh_vis_ctx_0')
filter(df_peak_intrasubj, clust=='lh_vis_ctx_0')[,2]
cor.test(filter(df_peak_intrasubj, clust=='lh_vis_ctx_0')[,2], filter(df_peak_intrasubj, clust=='lh_vis_ctx_0')[,3])
c(filter(df_peak_intrasubj, clust=='lh_vis_ctx_0')[,2], filter(df_peak_intrasubj, clust=='lh_vis_ctx_0')[,3])
c(filter(df_peak_intrasubj, clust=='lh_vis_ctx_0')$diff_wgc, filter(df_peak_intrasubj, clust=='lh_vis_ctx_0')$intra_subj_cor)
c(filter(df_peak_intrasubj, clust=='lh_vis_ctx_0')$diff_wgc, filter(df_peak_intrasubj, clust=='lh_vis_ctx_0')$intra_subj_cor)
cor.test(filter(df_peak_intrasubj, clust=='lh_vis_ctx_0')$diff_wgc, filter(df_peak_intrasubj, clust=='lh_vis_ctx_0')$intra_subj_cor)
for (clstr in levels(df_peak_intrasubj$clust)) {
print(cor.test(filter(df_peak_intrasubj, clust==clstr)$diff_wgc,
filter(df_peak_intrasubj, clust==clstr)$intra_subj_cor))
}
for (clstr in levels(df_peak_intrasubj$clust)) {
corrtest <- cor.test(filter(df_peak_intrasubj, clust==clstr)$diff_wgc,
filter(df_peak_intrasubj, clust==clstr)$intra_subj_cor))
if (corrtest$p.value <= .05) {
print(clstr)
print(corrtest)
}
}
for (clstr in levels(df_peak_intrasubj$clust)) {
corrtest <- cor.test(filter(df_peak_intrasubj, clust==clstr)$diff_wgc,
filter(df_peak_intrasubj, clust==clstr)$intra_subj_cor))
if (corrtest$p.value <= .05) {
print(clstr)
print(corrtest)
} else {
next
}
}
for (clstr in levels(df_peak_intrasubj$clust)) {
corrtest <- cor.test(filter(df_peak_intrasubj, clust==clstr)$diff_wgc,
filter(df_peak_intrasubj, clust==clstr)$intra_subj_cor)
if (corrtest$p.value <= .05) {
print(clstr)
print(corrtest)
}
}
filter(df_peak_intrasubj, clust=='lh_highlevel_0')
for (clstr in levels(df_peak_intrasubj$clust)) {
corrtest <- cor.test(filter(df_peak_intrasubj, clust==clstr)$diff_wgc,
filter(df_peak_intrasubj, clust==clstr)$intra_subj_cor)
print(corrtest)
}
qqnorm(filter(df_peak_intrasubj, clust=='lh_highlevel_0')$diff_wgc)
qqnorm(filter(df_peak_intrasubj, clust=='lh_highlevel_0')$intra_subj_cor)
qqnorm(filter(df_peak_intrasubj, clust=='lh_highlevel_1')$diff_wgc)
qqnorm(filter(df_peak_intrasubj, clust=='lh_highlevel_1')$intra_subj_cor)
qqnorm(filter(df_peak_intrasubj, clust=='lh_vis_ctx_0')$intra_subj_cor)
qqnorm(filter(df_peak_intrasubj, clust=='lh_vis_ctx_1')$intra_subj_cor)
qqnorm(filter(df_peak_intrasubj, clust=='lh_vis_ctx_0')$intra_subj_cor)
